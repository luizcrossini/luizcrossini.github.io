<!DOCTYPE html>
<html lang="pt-BR">
<head><meta charset="UTF-8"><meta name="viewport"content="width=device-width,initial-scale=1">
  <title>Login Google</title>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
  <div id="buttonDiv"></div>
  <script>
    Telegram.WebApp.expand();

    function handleCredentialResponse(response) {
      fetch('/auth/google', {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify({ idToken: response.credential })
      })
      .then(r => r.json())
      .then(({ token }) => {
        // envia token de volta ao bot dentro do Telegram
        Telegram.WebApp.sendData(JSON.stringify({ token }));
        Telegram.WebApp.close();
      })
      .catch(e => {
        alert('Erro no login Google: ' + e.message);
      });
    }

    window.onload = () => {
      google.accounts.id.initialize({
        client_id: 'SEU_GOOGLE_CLIENT_ID',
        callback: handleCredentialResponse
      });
      google.accounts.id.renderButton(
        document.getElementById('buttonDiv'),
        { theme: 'outline', size: 'large' }
      );
    };
  </script>
</body>
</html>